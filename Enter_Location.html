<!DOCTYPE html>
<html>

<head>
  <title>Got Wings! </title>
  <meta charset="utf-8" />

  <!--Import Google Icon Font-->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <!--Import materialize.css-->
  <!-- <link type="text/css" rel="stylesheet" href="css/materialize.min.css" media="screen,projection" /> -->

  <!--Let browser know website is optimized for mobile-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Compiled and minified CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-rc.2/css/materialize.min.css">

  <link rel="stylesheet" href="mystyle.css" />

  <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>
  <!-- Compiled and minified JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-rc.2/js/materialize.min.js"></script>
</head>

<body>
  <!-- Header -->
  <nav class="full-wrapper">
    <div class="container">
      <div class="nav-wrapper">
        <a href="#" class="brand-logo">
          <img class="materialboxed" width="65" src="winglogo.png">
        </a>
        <ul id="nav-mobile" class="right hide-on-med-and-down">
            <li>
              <a class="waves-effect waves-light btn" href="index_Got_Wings.html">HOME</a>
            </li>
            <li>
              <a class="waves-effect waves-light btn" href="badges.html">ABOUT US</a>
            </li>
            <li>
              <a class="waves-effect waves-light btn" href="Enter_Location.html">ENTER LOCATION</a>
            </li>
          </ul>
        </div>
      </div>
  </nav>
  <!--Carousel-->
  <div class="container">
    <form id="zipcode-form">

        <label for="zipcode-input">Choose Your Zipcode</label>

        <input type = "text" id = "zipcode-input">

        <!-- Test Button -->
        <input id = "user-zipcode" type = "submit" value = "Submit">

    </form>

    <!-- WOrking Button -->

    <div id="bus-data"></div>
<!-- 
    <table class="table">
            <thead>
              <tr>
                <th scope="col">Restaurant Name</th>
                <th scope="col">Address</th>
                <th scope="col">Actors</th>
              </tr>
            </thead>
            <tbody> -->
              <!-- Insert movie rows here -->
             </tbody>
          </table> 

    <script>

        var lat = "";

        var long = [];

        var locations = "";

      
        //var long = data.businesses.coordinates.longitude;
        //var lat = data.businesses.coordinates.latitude;

        mapboxgl.accessToken = 'pk.eyJ1IjoiamFpY2xhcmsxOTk1IiwiYSI6ImNqajFucWl3cTB1Z20zcXQ0NmF0ZjlkencifQ.M2jx9yaj8_XQONjv9iJLjg';
        var map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/mapbox/streets-v9',
            center: [-74.065707, 40.730771], // defaulted to rahway nj
             zoom: 13

        
        });


        mapboxgl.Map({
            container : 'map',
            center: [30, 30],
        });

        <div id="map" class="mapboxgl-map"> <div class="mapboxgl-canary" style="visibility: hidden;"> </div> <div class="mapboxgl-canvas-container mapboxgl-interactive mapboxgl-touch-drag-pan mapboxgl-touch-zoom-rotate"> <canvas class="mapboxgl-canvas" tabindex="0" aria-label="Map" width="516" height="400" style="position: absolute; width: 516px; height: 400px;"></canvas></div>

        <div class="mapboxgl-control-container"><div class="mapboxgl-ctrl-top-left"></div>
        
        <div class="mapboxgl-ctrl-top-right"></div><div class="mapboxgl-ctrl-bottom-left">
        
        <div class="mapboxgl-ctrl" style="display: block;"><a class="mapboxgl-ctrl-logo" target="_blank" href="https://www.mapbox.com/" aria-label="Mapbox logo" rel="noopener"></a></div></div>
        
        <div class="mapboxgl-ctrl-bottom-right"><div class="mapboxgl-ctrl mapboxgl-ctrl-attrib mapboxgl-compact"><a href="https://www.mapbox.com/about/maps/" target="_blank">© Mapbox</a> 
        
        <a href="http://www.openstreetmap.org/about/" target="_blank">© OpenStreetMap</a> <a class="mapbox-improve-map" href="https://www.mapbox.com/feedback/?owner=mapbox&amp;id=streets-v9&amp;access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4M29iazA2Z2gycXA4N2pmbDZmangifQ.-g_vE53SD2WrJ6tFX7QHmA" target="_blank">Improve this map</a></div></div></div></div>

        $("#user-zipcode").on('click', function (event) {
            // Preventing the button from trying to submit the form
            event.preventDefault();
            // Storing the zipcode entered
            var inputZip = $("#zipcode-input").val().trim();

            locations = inputZip;
            console.log(locations);


            // Create variable query for latitude and longitude
            var YELP_API = "xvXQKslc5FPXMQbD9aUwiI6W94gAZBYARoPj7sjmYXwkWgwXdSiOFVA_YNdtK8zXoxMNA-DrY1twG3F15bShs8Fppu064vISP15QkCiB5wVwz5AadFZEzepPrCFAW3Yx";
            
           
            //User enters in the zipcode that they want to use for the search

            // concatenate the long (-74.065707) and lat (40.730771) into the yelp api url. With a limit of 10 search results for Pizzeria
            const yelpURL = "https://api.yelp.com/v3/businesses/search?term=wings&location=" + locations + "&limit=10";
             //https://api.yelp.com/v3/businesses/search?location=07065&limit=10

            // proxy URL to fix CORS issue
            const proxyURL = 'https://shielded-hamlet-43668.herokuapp.com/';
            

            $.ajax({
                // concatenate the proxyURL with the yelpURL for the CORS issue
                url: proxyURL + yelpURL,
                method: 'GET',

                beforeSend: function (xhr, settings) {
                    xhr.setRequestHeader('Authorization', 'Bearer ' + YELP_API);
                },
                complete: function (response) {
                    // console.log(response);
                    // console.log(response.region);

                }

            }).done(function (data) {
                

                console.log(data);
                console.log(data.businesses[0].name, data.businesses[0].location.display_address[0], data.businesses[0].location.display_address[1]);
                console.log(data.businesses[1].name, data.businesses[1].location.display_address[0], data.businesses[1].location.display_address[1]);


                    
                for (i = 0; i < data.businesses.length; i++){
                    $("#bus-data").append(data.businesses[i].name + "<br>");
                    // $("#bus-data").append(data.businesses[i].location.display_address[i] + "<br>");

                }
                  
                  

            //    console.log(text);

            console.log(data.businesses[0].image_url);
            console.log(data.businesses[0].location.display_address);
            //     }

            var rName = data.businesses[0].name;
            var rLocation = data.businesses[0].location.display_address;
            var rlong = data.businesses[i]
           
            var newDiv = $('<div>');

            var childDiv = $('<div>');
            childDiv.append(rName);
            childDiv.append(rLocation);

            newDiv.append(childDiv);

            $('#text_printer').append(newDiv)

            });
        });
            
            
    </script>


    </div>
  </div>
  <!--Footer-->
  <footer class="page-footer-copyright">
    <div class="container">
      <!-- <img class="materialboxed" width="90" src="winglogo.png"> -->
      <h5 class="black-text">Contact Us</h5>
      <h6 class="black-text">Connect</h6>
      <a class="black-text" href="#!">© 2018 Copyright</a>
    </div>

    <div class="img-container">
      <div class="row">
        <div class="col 12 m7">
        </div>
        <div class="col s1">
          <img "materialboxed" width="50" src="fb.png">
        </div>
        <div class="col s1">
          <img "materialboxed" width="50" src="ig.png">
        </div>
        <div class="col s1">
          <img "materialboxed" width="50" src="tw.png">
        </div>
        <div class="col s1">
          <img "materialboxed" width="50" src="pt.png">
        </div>
      </div>
    </div>
    </div>
  </footer>
  <!--JavaScript at end of body for optimized loading-->
  <script type="text/javascript">

    $(document).ready(function () {
      $('.carousel').carousel();
    });

    $('.carousel').carousel('methodName');
    $('.carousel').carousel('methodName', paramName);

    instance.next();
    instance.next(4);

  </script>

</body>

</html>